<!DOCTYPE html>
<html lang="en">

<head>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138686867-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-138686867-1');
</script>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Cleaning Up Messy Column Names" />
<meta property="og:description" content="Cleaning Up Messy Column Names" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hampussanden.com/python/data_wrangling/pandas_cleaning_up_messy_column_names/" /><meta property="article:published_time" content="2020-08-20T11:53:49&#43;02:00"/>
<meta property="article:modified_time" content="2020-08-20T11:53:49&#43;02:00"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cleaning Up Messy Column Names"/>
<meta name="twitter:description" content="Cleaning Up Messy Column Names"/>
<meta name="generator" content="Hugo 0.53" /> 
    
    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Cleaning Up Messy Column Names",
  "url": "https:\/\/hampussanden.com\/python\/data_wrangling\/pandas_cleaning_up_messy_column_names\/",
  "wordCount": "644",
  "datePublished": "2020-08-20T11:53:49\u002b02:00",
  "dateModified": "2020-08-20T11:53:49\u002b02:00",
  "author": {
    "@type": "Person",
    "name": "Hampus Sandén"
  },
  "description": "Cleaning Up Messy Column Names"
}
</script> 

    <title>Cleaning Up Messy Column Names</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">
    
    
    <link href="https://hampussanden.com/css/custom.css" rel="stylesheet"> 
    <link href="https://hampussanden.com/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">
        
    <link href="" rel="alternate" type="application/rss+xml" title="Hampus Sandén" /> 
    
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<link rel="apple-touch-icon" sizes="57x57" href="https://hampussanden.com/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://hampussanden.com/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://hampussanden.com/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://hampussanden.com/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://hampussanden.com/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://hampussanden.com/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://hampussanden.com/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://hampussanden.com/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://hampussanden.com/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="https://hampussanden.com/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hampussanden.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://hampussanden.com/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://hampussanden.com/favicon-16x16.png">
<link rel="manifest" href="https://hampussanden.com/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://hampussanden.com/">Carl Hampus Sandén</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="https://hampussanden.com/#articles">Articles</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            About
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://hampussanden.com/about/hampus_sanden/">About Hampus</a>
                            <a class="dropdown-item" href="https://github.com/hampussanden">GitHub</a>
                            <a class="dropdown-item" href="https://www.linkedin.com/in/hampussanden/">LinkedIn</a>
                            <a class="dropdown-item" href="https://twitter.com/hampussanden">Twitter</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                 


<article>
  <div class="technical_note">
  <header>
    <h1 class="technical_note_title">Cleaning Up Messy Column Names</h1>
    <div class="technical_note_date">
      <time datetime=" 2020-08-20T11:53:49&#43;02:00 "> 20 Aug 2020</time>
    </div>
  </header>
  <div class="content">
  <p>Sometimes you load in that DataFrame from a csv or excel file that some unlucky excel user created and you just wish everyone used Python. Why do they have to make the column names uppercase, with spaces, and whitespace all around? Do they like doing this to you? They probably hate you, that’s it. They did this:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/iowa_liqour_sales.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Invoice/Item Number</th>
      <th>Date</th>
      <th>Store Number</th>
      <th>Store Name</th>
      <th>Address</th>
      <th>City</th>
      <th>Zip Code</th>
      <th>Store Location</th>
      <th>County Number</th>
      <th>County</th>
      <th>...</th>
      <th>Item Number</th>
      <th>Item Description</th>
      <th>Pack</th>
      <th>Bottle Volume (ml)</th>
      <th>State Bottle Cost</th>
      <th>State Bottle Retail</th>
      <th>Bottles Sold</th>
      <th>Sale (Dollars)</th>
      <th>Volume Sold (Liters)</th>
      <th>Volume Sold (Gallons)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S29198800001</td>
      <td>11/20/2015</td>
      <td>2191</td>
      <td>Keokuk Spirits</td>
      <td>1013 MAIN</td>
      <td>KEOKUK</td>
      <td>52632</td>
      <td>1013 MAIN\nKEOKUK 52632\n(40.39978, -91.387531)</td>
      <td>56</td>
      <td>Lee</td>
      <td>...</td>
      <td>297</td>
      <td>Templeton Rye w/Flask</td>
      <td>6</td>
      <td>750</td>
      <td>$18.09</td>
      <td>$27.14</td>
      <td>6</td>
      <td>$162.84</td>
      <td>4.50</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S29195400002</td>
      <td>11/21/2015</td>
      <td>2205</td>
      <td>Ding's Honk And Holler</td>
      <td>900 E WASHINGTON</td>
      <td>CLARINDA</td>
      <td>51632</td>
      <td>900 E WASHINGTON\nCLARINDA 51632\n(40.739238, ...</td>
      <td>73</td>
      <td>Page</td>
      <td>...</td>
      <td>297</td>
      <td>Templeton Rye w/Flask</td>
      <td>6</td>
      <td>750</td>
      <td>$18.09</td>
      <td>$27.14</td>
      <td>12</td>
      <td>$325.68</td>
      <td>9.00</td>
      <td>2.38</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S29050300001</td>
      <td>11/16/2015</td>
      <td>3549</td>
      <td>Quicker Liquor Store</td>
      <td>1414 48TH ST</td>
      <td>FORT MADISON</td>
      <td>52627</td>
      <td>1414 48TH ST\nFORT MADISON 52627\n(40.624226, ...</td>
      <td>56</td>
      <td>Lee</td>
      <td>...</td>
      <td>249</td>
      <td>Disaronno Amaretto Cavalli Mignon 3-50ml Pack</td>
      <td>20</td>
      <td>150</td>
      <td>$6.40</td>
      <td>$9.60</td>
      <td>2</td>
      <td>$19.20</td>
      <td>0.30</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S28867700001</td>
      <td>11/04/2015</td>
      <td>2513</td>
      <td>Hy-Vee Food Store #2 / Iowa City</td>
      <td>812  S 1ST AVE</td>
      <td>IOWA CITY</td>
      <td>52240</td>
      <td>812 S 1ST AVE\nIOWA CITY 52240\n</td>
      <td>52</td>
      <td>Johnson</td>
      <td>...</td>
      <td>237</td>
      <td>Knob Creek w/ Crystal Decanter</td>
      <td>3</td>
      <td>1750</td>
      <td>$35.55</td>
      <td>$53.34</td>
      <td>3</td>
      <td>$160.02</td>
      <td>5.25</td>
      <td>1.39</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S29050800001</td>
      <td>11/17/2015</td>
      <td>3942</td>
      <td>Twin Town Liquor</td>
      <td>104 HIGHWAY 30 WEST</td>
      <td>TOLEDO</td>
      <td>52342</td>
      <td>104 HIGHWAY 30 WEST\nTOLEDO 52342\n(41.985887,...</td>
      <td>86</td>
      <td>Tama</td>
      <td>...</td>
      <td>249</td>
      <td>Disaronno Amaretto Cavalli Mignon 3-50ml Pack</td>
      <td>20</td>
      <td>150</td>
      <td>$6.40</td>
      <td>$9.60</td>
      <td>2</td>
      <td>$19.20</td>
      <td>0.30</td>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>

<p>Now you can’t reference the columns with the convenient .{column name here} notation. You’ll have to do the [&ldquo;] thing. It’s not the most horrible thing that ever happened, you’ve been through a lot. You can take it. But you’re used to the other way. Plus, what’s with those parentheses? You can’t have that.
Luckily, pandas has a convenient .str method that you can use on text data. Since the column names are an ‘index’ type, you can use .str on them too. You can fix all these lapses of judgement by chaining together a bunch of these .str functions. Like so:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>invoice/item_number</th>
      <th>date</th>
      <th>store_number</th>
      <th>store_name</th>
      <th>address</th>
      <th>city</th>
      <th>zip_code</th>
      <th>store_location</th>
      <th>county_number</th>
      <th>county</th>
      <th>...</th>
      <th>item_number</th>
      <th>item_description</th>
      <th>pack</th>
      <th>bottle_volume_ml</th>
      <th>state_bottle_cost</th>
      <th>state_bottle_retail</th>
      <th>bottles_sold</th>
      <th>sale_dollars</th>
      <th>volume_sold_liters</th>
      <th>volume_sold_gallons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S29198800001</td>
      <td>11/20/2015</td>
      <td>2191</td>
      <td>Keokuk Spirits</td>
      <td>1013 MAIN</td>
      <td>KEOKUK</td>
      <td>52632</td>
      <td>1013 MAIN\nKEOKUK 52632\n(40.39978, -91.387531)</td>
      <td>56</td>
      <td>Lee</td>
      <td>...</td>
      <td>297</td>
      <td>Templeton Rye w/Flask</td>
      <td>6</td>
      <td>750</td>
      <td>$18.09</td>
      <td>$27.14</td>
      <td>6</td>
      <td>$162.84</td>
      <td>4.50</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S29195400002</td>
      <td>11/21/2015</td>
      <td>2205</td>
      <td>Ding's Honk And Holler</td>
      <td>900 E WASHINGTON</td>
      <td>CLARINDA</td>
      <td>51632</td>
      <td>900 E WASHINGTON\nCLARINDA 51632\n(40.739238, ...</td>
      <td>73</td>
      <td>Page</td>
      <td>...</td>
      <td>297</td>
      <td>Templeton Rye w/Flask</td>
      <td>6</td>
      <td>750</td>
      <td>$18.09</td>
      <td>$27.14</td>
      <td>12</td>
      <td>$325.68</td>
      <td>9.00</td>
      <td>2.38</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S29050300001</td>
      <td>11/16/2015</td>
      <td>3549</td>
      <td>Quicker Liquor Store</td>
      <td>1414 48TH ST</td>
      <td>FORT MADISON</td>
      <td>52627</td>
      <td>1414 48TH ST\nFORT MADISON 52627\n(40.624226, ...</td>
      <td>56</td>
      <td>Lee</td>
      <td>...</td>
      <td>249</td>
      <td>Disaronno Amaretto Cavalli Mignon 3-50ml Pack</td>
      <td>20</td>
      <td>150</td>
      <td>$6.40</td>
      <td>$9.60</td>
      <td>2</td>
      <td>$19.20</td>
      <td>0.30</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S28867700001</td>
      <td>11/04/2015</td>
      <td>2513</td>
      <td>Hy-Vee Food Store #2 / Iowa City</td>
      <td>812  S 1ST AVE</td>
      <td>IOWA CITY</td>
      <td>52240</td>
      <td>812 S 1ST AVE\nIOWA CITY 52240\n</td>
      <td>52</td>
      <td>Johnson</td>
      <td>...</td>
      <td>237</td>
      <td>Knob Creek w/ Crystal Decanter</td>
      <td>3</td>
      <td>1750</td>
      <td>$35.55</td>
      <td>$53.34</td>
      <td>3</td>
      <td>$160.02</td>
      <td>5.25</td>
      <td>1.39</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S29050800001</td>
      <td>11/17/2015</td>
      <td>3942</td>
      <td>Twin Town Liquor</td>
      <td>104 HIGHWAY 30 WEST</td>
      <td>TOLEDO</td>
      <td>52342</td>
      <td>104 HIGHWAY 30 WEST\nTOLEDO 52342\n(41.985887,...</td>
      <td>86</td>
      <td>Tama</td>
      <td>...</td>
      <td>249</td>
      <td>Disaronno Amaretto Cavalli Mignon 3-50ml Pack</td>
      <td>20</td>
      <td>150</td>
      <td>$6.40</td>
      <td>$9.60</td>
      <td>2</td>
      <td>$19.20</td>
      <td>0.30</td>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>

</div>
  <aside>
      <div class="bug_reporting">
          <h4>Find an error or bug?</h4>
          <p>Everything on this site is available on GitHub. Head to <a href='https://github.com/hampussanden/notes/issues/new'>and submit a suggested change</a>. You can also message me directly on <a href='https://twitter.com/hampussanden'>Twitter</a>.</p>
      </div>
      </aside>

    </div>
</article>




            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 7 pages and is available on <a href="https://github.com/hampussanden/notes">GitHub</a>. Copyright &copy; Hampus Sandén, <time datetime="2018">2018</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>